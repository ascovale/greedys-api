# Profilo neutro - nessun default
# Per Docker: docker-compose specificherà SPRING_PROFILES_ACTIVE=docker
# Per sviluppo locale minimal: --spring.profiles.active=dev-minimal  
# Per sviluppo locale con DB locale: --spring.profiles.active=dev
# spring.profiles.active=configurato-tramite-parametri-o-variabili

# === CONFIGURAZIONE SERVIZI REALI vs MOCK ===
# Attiva tutti i servizi reali per default (disattiva mock)
# I profili specifici possono sovrascrivere se necessario
firebase.enabled=true
google.maps.enabled=true
twilio.enabled=true
notifications.enabled=true
google.oauth.enabled=true
app.mode=production

# Hibernate debug logs (commented for performance)
#logging.level.org.hibernate.SQL=DEBUG
#logging.level.org.hibernate.transaction=TRACE
#logging.level.org.hibernate.engine.transaction=TRACE
#logging.level.org.hibernate.event.internal.DefaultFlushEventListener=TRACE
#logging.level.org.hibernate.event.internal.AbstractFlushingEventListener=TRACE

## Logging

# Spring debug logs (abilitati per vedere le chiamate ai controller)
#logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=DEBUG
#logging.level.org.springframework.beans.factory=DEBUG
#logging.level.org.springframework.context=DEBUG
#logging.level.org.springframework.transaction=DEBUG

# Suppress authentication warnings for multi-tenant setup
logging.level.org.springframework.security.config.annotation.authentication.configurers.provisioning.InitializeUserDetailsManagerConfigurer=ERROR
logging.level.org.springframework.security.config.annotation.authentication.configurers.provisioning.InitializeAuthenticationProviderManagerConfigurer=ERROR

# Log specifici per APPLICATION - TUTTI i controller e services saranno inclusi
logging.level.com.application=DEBUG
logging.level.com.application.restaurant.controller=DEBUG
logging.level.com.application.customer.controller=DEBUG
logging.level.com.application.admin.controller=DEBUG
logging.level.com.application.common.controller=DEBUG
logging.level.com.application.restaurant.service=DEBUG
logging.level.com.application.customer.service=DEBUG
logging.level.com.application.admin.service=DEBUG
logging.level.com.application.common.service=DEBUG
logging.level.com.application.security=DEBUG
logging.level.com.application.persistence=DEBUG
logging.level.com.application.security.user.restaurant=DEBUG


#logging.level.org.springframework=DEBUG
#logging.level.org.springframework.beans.factory=DEBUG
#logging.level.org.hibernate.SQL=DEBUG
#logging.level.org.springframework.data.jpa=DEBUG
#logging.level.org.springframework.web=DEBUG
#logging.level.org.springframework.security=DEBUG

#logging.level.org.springframework.web.filter.CommonsRequestLoggingFilter=DEBUG
#spring.mvc.log-request-details=true

## Token

# JWT Secret viene configurato tramite profili specifici:
# - Dev: tramite application-dev.properties (file locale)
# - Docker: tramite Docker secrets in application-docker.properties
# jwt.secret=configurato-nei-profili-specifici

# FALLBACK per profilo dev se non viene caricato correttamente
jwt.secret=file:./dev-secrets/jwt_secret

jwt.expiration=3600000
# Refresh token duration: 7 days (7 * 24 * 60 * 60 * 1000 = 604800000 ms)
jwt.refresh.expiration=604800000

## Database

# Configurazioni database specificate nei profili:
# - dev: H2 in memoria (application-dev.properties)
# - docker: MySQL container (application-docker.properties)  
# - prod: MySQL esterno (application-prod.properties)

# JPA Configurazioni comuni
spring.jpa.generate-ddl=true
spring.jpa.hibernate.ddl-auto=update
# Disable open-in-view to avoid database queries during view rendering
spring.jpa.open-in-view=false

#spring.jpa.show-sql=true

#spring.jpa.properties.hibernate.format_sql=true
#spring.jpa.properties.hibernate.use_sql_comments=true

# SpringDoc OpenAPI configuration
springdoc.api-docs.path=/v3/api-docs
springdoc.api-docs.groups.enabled=true
springdoc.swagger-ui.enabled=false
# Exclude internal model classes from OpenAPI documentation
springdoc.packages-to-exclude=com.application.common.persistence.model.reservation

# disable timestamp (numeric/array) dates
spring.jackson.serialization.write-dates-as-timestamps=false

# (optional) enforce your preferred date format
spring.jackson.date-format=yyyy-MM-dd

# Naming strategy
# Use spring.jpa.properties.* for Hibernate native properties (the prefix is
# stripped before adding them to the entity manager)

## MULTIPART (MultipartProperties)
# Enable multipart uploads
spring.servlet.multipart.enabled=true
# Threshold after which files are written to disk.
spring.servlet.multipart.file-size-threshold=2KB
# Max file size.
spring.servlet.multipart.max-file-size=200MB
# Max Request Size
spring.servlet.multipart.max-request-size=215MB
spring.web.resources.static-locations=classpath:/static/,file:/static/

# Enable all Actuator endpoints
management.endpoints.web.exposure.include=*

# Set the base path for Actuator endpoints
management.endpoints.web.base-path=/actuator

# Adjust the disk space threshold for the health check
management.health.diskspace.threshold=1MB

baseUrl=http://localhost:8080

# OAuth2 e servizi esterni configurati nei profili specifici

## Google OAuth2 Client IDs (pubblici - comuni a tutti gli ambienti)
google.oauth.client.id=982346813437-3s1uepb5ic7ib5r4mfegdsbrkjjvtl7b.apps.googleusercontent.com
google.oauth.web.client.id=982346813437-3s1uepb5ic7ib5r4mfegdsbrkjjvtl7b.apps.googleusercontent.com
google.oauth.flutter.client.id=982346813437-d0kerhe6h2km0veqs563avsgtv6vb7p5.apps.googleusercontent.com
google.oauth.android.client.id=982346813437-e1vsuujvorosiaamfdc3honrrbur17ri.apps.googleusercontent.com
google.oauth.ios.client.id=982346813437-iosclientid.apps.googleusercontent.com

# Email Configuration

# Configurazioni email specificate nei profili:
# - dev: Email disabilitata o mock
# - docker: Configurazione Aruba completa  
# - prod: Configurazione Aruba completa

## Task Scheduling

# Purge expired tokens every day at 2:00 AM
purge.cron.expression=0 0 2 * * ?

## Address Validation and Geocoding

# Configurazioni API specificate nei profili:
# - dev: API keys di sviluppo o mock
# - docker: API keys reali  
# - prod: API keys di produzione

# Hibernate Envers Configuration
spring.jpa.properties.org.hibernate.envers.audit_table_suffix=_AUD
spring.jpa.properties.org.hibernate.envers.revision_field_name=REV
spring.jpa.properties.org.hibernate.envers.revision_type_field_name=REVTYPE
spring.jpa.properties.org.hibernate.envers.store_data_at_delete=true
spring.jpa.properties.org.hibernate.envers.global_with_modified_flag=true
spring.jpa.properties.org.hibernate.envers.revision_on_collection_change=false

## Notification Outbox Poller Configuration

# ⭐ MULTI-POLLER CONTROL FLAG
# true  = FAST poller attivo (ogni 1 secondo, notifiche in ~1-2s)
#         + SLOW poller attivo (ogni 30 secondi, pulisce vecchi stuck)
# false = FAST poller attivo (ogni 1 secondo, notifiche in ~1-2s)
#         SLOW poller disabilitato
notification.outbox.multi-poller.enabled=false

# ⭐ FAST POLLER CONFIG (sempre attivo)
# Intervallo in millisecondi tra le esecuzioni del FAST poller
notification.outbox.fast-poller.delay-ms=1000
# Finestra temporale (in secondi) per considerare un evento "NUOVO"
notification.outbox.fast-poller.fresh-event-window-seconds=60

# ⭐ SLOW POLLER CONFIG (attivo solo se multi-poller.enabled=true)
# Intervallo in millisecondi tra le esecuzioni dello SLOW poller
notification.outbox.slow-poller.delay-ms=30000
# Soglia (in secondi) oltre la quale un evento è considerato "VECCHIO/STUCK"
notification.outbox.slow-poller.stuck-event-threshold-seconds=60

## WebSocket Buffer Configuration
# Aumenta il send buffer per evitare "Failed to send message within the configured send limit"
spring.websocket.servlet.buffer-size=65536
server.tomcat.max-http-post-size=52428800
